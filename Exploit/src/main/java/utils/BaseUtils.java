package utils;

import com.google.gson.JsonObject;
import com.google.gson.JsonParser;
import com.jayway.restassured.RestAssured;
import com.jayway.restassured.response.Response;
import com.jayway.restassured.http.ContentType;

public class BaseUtils {

      public JsonObject invokeRestAPI(String instnaceName, String webPort, String tenant, String service, String api, String requestBody) {
        Response getResponse = null;
        String url = String.format("http://manage.%s.riversand-dataplatform.com:%s/%s/api/%s/%s", instnaceName, webPort, tenant, service, api);
        try {
            getResponse = RestAssured.given()
                    .contentType(ContentType.JSON)
                    .header("x-rdp-version", "8.1")
                    .header("x-rdp-clientId", "rdpclient")
                    .header("x-rdp-tenantId:", tenant)
                    .header("x-rdp-ownershipData", "Nike")
                    .header("x-rdp-userId", "system_user")
                    .header("x-rdp-userName", "System User")
                    .header("x-rdp-firstName", "System")
                    .header("x-rdp-lastName", "User")
                    .header("x-rdp-userEmail", "system.user@riversand.com")
                    .header("x-rdp-userRoles", "[\"admin\"]")
                    .body(requestBody)
                    .when()
                    .post(url);

        } catch (Exception ex) {
            ex.printStackTrace();
            return null;
        }
        return new JsonParser().parse(getResponse.getBody().asString()).getAsJsonObject();
    }

    //with clientid
    public JsonObject invokeRestAPI(String instnaceName, String webPort, String tenant, String service, String api, String requestBody, String clientId) {
        Response getResponse = null;
        String url = String.format("http://manage.%s.riversand-dataplatform.com:%s/%s/api/%s/%s", instnaceName, webPort, tenant, service, api);
        try {
            getResponse = RestAssured.given()
                    .contentType(ContentType.JSON)
                    .header("x-rdp-version", "8.1")
                    .header("x-rdp-clientId", clientId)
                    .header("x-rdp-tenantId:", tenant)
                    .header("x-rdp-ownershipData", "Nike")
                    .header("x-rdp-userId", "system_user")
                    .header("x-rdp-userName", "System User")
                    .header("x-rdp-firstName", "System")
                    .header("x-rdp-lastName", "User")
                    .header("x-rdp-userEmail", "system.user@riversand.com")
                    .header("x-rdp-userRoles", "[\"admin\"]")
                    .body(requestBody)
                    .when()
                    .post(url);

        } catch (Exception ex) {
            ex.printStackTrace();
            return null;
        }
        return new JsonParser().parse(getResponse.getBody().asString()).getAsJsonObject();
    }
}

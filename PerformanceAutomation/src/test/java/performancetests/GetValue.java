package performancetests;

import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.testng.annotations.Test;
import utilities.RiversandMaster;

import java.io.File;
import java.io.FileInputStream;
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Pattern;

/**
 * Created by harshithgn on 1/10/2018.
 */
public class GetValue {
    RiversandMaster objRiversandMaster = new RiversandMaster();

    @Test
    public void mthod1(){
        try {
            FileInputStream inputStream;
            String excelFilePath = "C:\\DataFile\\sunil.xls";
            inputStream = new FileInputStream(new File(excelFilePath));
            HSSFWorkbook workbook = new HSSFWorkbook(inputStream);
            HSSFSheet sheet = workbook.getSheet("Sheet1");
            String rowVal, colVal, cellVal, temp = "";
            String[] rowValSplit = new String[20];

            int getRowCount = RiversandMaster.getRowCount("Sheet1", workbook);
            int getColCount = RiversandMaster.getColCount("Sheet1", workbook);
            for(int i=1; i<=getRowCount; i++){
                temp="";
                for(int j=1; j<getColCount; j++){
                    rowValSplit = sheet.getRow(i).getCell(0).toString().split(Pattern.quote("_"));
                    for(int k=0; k<rowValSplit.length; k++){
                        colVal = sheet.getRow(0).getCell(j).toString().replace(" ", "").toLowerCase();
                        if(rowValSplit[k].equals(colVal)){
                            cellVal = sheet.getRow(i).getCell(j).toString();
                            temp = temp + " " + cellVal;
                        }
                    }
                }
                System.out.println(temp);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
